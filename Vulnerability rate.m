clear;
clc;

%% 构造地铁站间骑行时间矩阵
n=344;
% metro_bicycle=zeros(n); %骑行时间矩阵
% A=xlsread('C:\Users\HP\Desktop\骑行时间邻接表.xlsx');  %118336*1的矩阵
% 
% t=1;  %判断在第几行
% for i =1:length(A)
%     yushu=mod(i,344);
%     if yushu == 0
%         yushu =344;
%         metro_bicycle(t,yushu)=A(i);
%         t=t+1;
%     else
%         metro_bicycle(t,yushu)=A(i);
%     end
% end
load metro_bicycle
%% 初始化各类矩阵

%初始客流矩阵
original_OD=zeros(n);     
B=xlsread('C:\Users\59464\Desktop\Volume20200106.xlsx','4-24');
for m = 1:length(B)
    original_OD(B(m,1),B(m,2))=B(m,3);
end
original_OD([1:n+1:n^2])=0;

%初始邻接矩阵
original_admatrix=zeros(n);
C=xlsread('C:\Users\HP\Desktop\beijinghalf.xlsx','2019带环球度假区');
for p = 1:length(C)
    original_admatrix(C(p,1),C(p,2))=1;
end
original_admatrix=original_admatrix+original_admatrix';
original_admatrix(original_admatrix==0)=inf;

%初始时间矩阵
original_time_matrix=zeros(n);
for p = 1:length(C)
    original_time_matrix(C(p,1),C(p,2))=C(p,3);
end
original_time_matrix=original_time_matrix+original_time_matrix';
original_time_matrix(original_time_matrix==0)=inf;

%% 根据失效车站计算最短路矩阵及客流矩阵
Ef=zeros(1,n);

parfor r =1:n
    
    %0-计算正常情况下的网络效率
    temp_admatrix = original_admatrix;
    temp_admatrix([1:n+1:n^2])=0;
    
    for k=1:n
        for i = 1:n
            for j=1:n
                if temp_admatrix(i,j)>temp_admatrix(i,k)+temp_admatrix(k,j)
                temp_admatrix(i,j)=temp_admatrix(i,k)+temp_admatrix(k,j);
                end
            end
        end
    end
    
    DS=1./temp_admatrix;   %最短路倒数矩阵 
    DS(DS==inf)=0;
    
    temp_OD=original_OD;
    temp_OD([1:n+1:n^2])=0;
    e=temp_OD.*DS;
    total_volume=sum(sum(original_OD));
    E=(sum(e(:)))/(344*343*total_volume);
    
    %1-计算某一站点失效后的拓扑最短路矩阵
    temp_admatrix = original_admatrix;
    temp_admatrix(r,:)=inf;
    temp_admatrix(:,r)=inf;
    temp_admatrix([1:n+1:n^2])=0;
    
    for k=1:n
        for i = 1:n
            for j=1:n
                if temp_admatrix(i,j)>temp_admatrix(i,k)+temp_admatrix(k,j)
                temp_admatrix(i,j)=temp_admatrix(i,k)+temp_admatrix(k,j);
                end
            end
        end
    end
    
    DS=1./temp_admatrix;   %最短路倒数矩阵 
    DS(DS==inf)=0;

    %2-计算某一站点失效后的时间最短路矩阵
    temp_time_matrix = original_time_matrix;
    temp_time_matrix(r,:)=inf;
    temp_time_matrix(:,r)=inf;
    temp_time_matrix([1:n+1:n^2])=0;
    
    for k=1:n
        for i = 1:n
            for j=1:n
                if temp_time_matrix(i,j)>temp_time_matrix(i,k)+temp_time_matrix(k,j)
                temp_time_matrix(i,j)=temp_time_matrix(i,k)+temp_time_matrix(k,j);
                end
            end
        end
    end
    
    %3.1-计算某一站点失效后的客流分配结果-出发站
    temp_OD=original_OD;
    temp_OD([1:n+1:n^2])=0;
    temp_metro_bicycle=metro_bicycle;
    temp_metro_bicycle([1:n+1:n^2])=999999;  %方便选取前三个最近的车站

    for s=1:n
        if s~=r
            row_time=zeros(1,n);  %存储绕行后的总时间
            
            for t=1:n
                if t~=s
                    row_time(t)=temp_metro_bicycle(r,t)+temp_time_matrix(t,s);
                else
                     row_time(t)=9999;
                end
            end
            
            row_OD=temp_OD(r,s);   %提取第r行s列OD
            [mint,minnum] = mink(row_time,3);    %计算最短时间的三个车站的位置
            avet_invert=3/sum(mint);         %改进logit模型
            theta=2;%设置参数
            %计算分配的概率
            Possible_k1=(1/exp(theta*mint(1)* avet_invert))/((1/exp(theta*mint(1)* avet_invert))+(1/exp(theta*mint(2)* avet_invert))+(1/exp(theta*mint(3)* avet_invert)));
            Possible_k2=(1/exp(theta*mint(2)* avet_invert))/((1/exp(theta*mint(1)* avet_invert))+(1/exp(theta*mint(2)* avet_invert))+(1/exp(theta*mint(3)* avet_invert)));
            Possible_k3=(1/exp(theta*mint(3)* avet_invert))/((1/exp(theta*mint(1)* avet_invert))+(1/exp(theta*mint(2)* avet_invert))+(1/exp(theta*mint(3)* avet_invert)));
            %分配客流转移   
            temp_OD(minnum(1),s)=temp_OD(minnum(1),s)+row_OD*Possible_k1;
            temp_OD(minnum(2),s)=temp_OD(minnum(2),s)+row_OD*Possible_k2;
            temp_OD(minnum(3),s)=temp_OD(minnum(3),s)+row_OD*Possible_k3;
            %受损车站客流变为0
            temp_OD(r,s)=0;
        end
    end

    %3.2-计算某一站点失效后的客流分配结果-终点站
    for s=1:n
        if s~=r
            row_time=zeros(1,n);  %存储绕行后的总时间
            
            for t=1:n
                if t~=s
                    row_time(t)=temp_time_matrix(s,t)+temp_metro_bicycle(t,r);
                else
                    row_time(t)=9999;
                end    
            end
            
            row_OD=temp_OD(s,r);   %提取第s行r列OD
            [mint,minnum] = mink(row_time,3);    %计算最短时间的三个车站的位置
            avet_invert=3/sum(mint);         %改进logit模型
            theta=2;%设置参数
            %计算分配的概率
            Possible_k1=(1/exp(theta*mint(1)* avet_invert))/((1/exp(theta*mint(1)* avet_invert))+(1/exp(theta*mint(2)* avet_invert))+(1/exp(theta*mint(3)* avet_invert)));
            Possible_k2=(1/exp(theta*mint(2)* avet_invert))/((1/exp(theta*mint(1)* avet_invert))+(1/exp(theta*mint(2)* avet_invert))+(1/exp(theta*mint(3)* avet_invert)));
            Possible_k3=(1/exp(theta*mint(3)* avet_invert))/((1/exp(theta*mint(1)* avet_invert))+(1/exp(theta*mint(2)* avet_invert))+(1/exp(theta*mint(3)* avet_invert)));
            %分配客流转移   
            temp_OD(s,minnum(1))=temp_OD(s,minnum(1))+row_OD*Possible_k1;
            temp_OD(s,minnum(2))=temp_OD(s,minnum(2))+row_OD*Possible_k2;
            temp_OD(s,minnum(3))=temp_OD(s,minnum(3))+row_OD*Possible_k3;
            %受损车站客流变为0
            temp_OD(s,r)=0;
        end
    end
    
    temp_OD(isnan(temp_OD))=0;
 
    %4-计算车站的全局效率
    ee=temp_OD.*DS;
    EE=(sum(ee(:)))/(344*343*total_volume);
    Ef(r)=abs(E-EE)/EE;
      
end

%% 画图
clc;clear;
x=1:344;
y1=[0.00101342	0.00236326	0.00887994	0.009227556	0.014308986	0.01498424	0.022370116	0.027342251	0.01031869	0.000550906	0.001408156	0.004999319	0.00108647	0.001297893	0.000387157	0.000267605	0.00162993	0.005515092	0.000718401	0.003232655	0.019390777	0.012603237	0.005743433	0.012175335	0.000436198	0.005820019	0.001547654	0.004169325	0.001885249	0.002521161	0.006115089	0.00120328	0.006861961	0.00155166	0.001223296	0.007418483	0.002222204	0.001018171	0.009194545	0.000664002	0.001284324	0.013308345	0.014938218	0.013509657	0.01172424	0.021972812	0.000232631	0.000537726	0.002148094	0.000114525	0.000877621	0.002424868	0.000325776	0.00161259	0.013385861	0.004292365	0.002100756	0.005496648	0.025135739	0.018284437	0.010911474	0.001501644	0.006087687	0.004216594	0.008132437	0.001268456	0.004874942	0.000395092	0.000687682	0.000288914	0.000579147	0.005371338	0.001246541	0.003738746	0.001561898	0.000715966	0.045352032	0.02217771	0.006657423	0.003912363	0.011947974	0.022010032	0.002097949	0.007676851	0.000381353	0.001522331	0.005352994	0.001290214	0.008880133	0.048305992	0.02605188	0.019068611	0.021464334	0.026981109	0.019885352	0.016829758	0.023708676	0.000108839	0.000735356	0.002885156	0.021184736	0.001794749	0.002222278	0.003130976	3.82E-05	0.00142533	0.009656222	0.001448942	0.006559663	0.000436173	0.001049666	0.014142836	0.001069748	0.014827118	0.015971739	0.018188912	0.023977613	0.012500702	0.000289472	0.001027932	0.002851567	0.003985863	0.000489541	0.005033861	0.019774029	0.000153124	0.000144349	0.000612657	0.000371484	0.010333614	0.002173377	0.016193258	0.001349657	0.002433607	0.000722012	0.000973531	0.007030188	0.000624159	0.000477758	0.000451573	0.002173729	1.42E-05	0.002242411	0.00181019	0.000559016	0.008521995	0.001889672	0.000344798	0.001919928	0.002317878	0.002352233	0.001607288	0.000822502	4.64E-05	0.000201581	0.000389419	0.005810567	0.014941118	0.017368762	0.029834126	0.010564842	0.00230809	0.013851272	0.008612577	6.48E-06	4.24E-05	0.000819577	0.001565534	0.002337673	0.003018228	0.005795616	0.034332308	0.022266786	0.016150888	0.017218212	0.014559073	0.011383028	0.008922889	0.00993183	0.009787136	0.003445109	0.002987546	0.01135053	0.009578328	0.007036626	0.00773406	0.008090411	0.002881601	0.004213858	0.002970973	0.001257599	0.001469037	0.001157275	0.004192599	0.007353335	0.005084508	0.026076873	0.010233104	0.015249095	0.01096564	0.007812638	0.010741713	0.011040648	0.008521096	0.005504973	0.006891435	0.006298052	0.002123864	0.001063003	0.000927547	0.014252742	0.016168006	0.004829385	0.006109259	0.005395472	0.005140989	0.003935483	0.002474146	0.00204044	0.000794674	0.003192627	0.003042545	0.01257871	0.010184769	0.011823085	0.009724439	0.008404188	0.00718864	0.00437923	0.005054915	0.006479318	0.002080098	0.001286807	0.0003166	0.000577119	0.000146496	0.004221421	0.005936038	0.001410876	0.002236134	0.005166969	0.005368358	0.003407288	0.006470926	0.007969057	0.007906669	0.008963965	0.000904192	0.000236037	0.001598268	0.000322364	0.005321698	0.000291162	0.000330001	0.001890903	0.001764942	0.00258749	0.004138793	0.002710775	0.005449789	0.008591158	0.010680804	0.010739562	0.009354243	0.005534453	0.008054433	0.002307456	0.004008996	0.002984377	0.001540594	0.00045415	0.000143536	0.000292114	0.000614063	0.000729588	0.000865559	0.000813801	0.001028432	0.00146147	0.001275318	0.007288223	0.001612195	0.0005863	0.000111235	0.000769867	0.000222919	0.005389535	0.004205726	0.003824822	0.003980068	0.002472741	0.002339186	0.001499625	0.001974828	0.001126625	0.000747608	0.01478882	0.000818731	0.001826422	0.0071511	0.00046883	0.000774182	0.012107067	0.000175708	0.000531297	6.28E-05	0.000243547	0.001457867	0.011755616	0.003468711	0.001217094	0.004710033	0.002507504	0.004518302	0.005567254	0.005669753	0.012071689	0.002396742	0.001527166	0.000403618	0.000135525	0.000809107	0.001161717	0.000832373	0.002198107	1.75E-05	0.000123307	0.000411826	3.14E-05	0.006664078	0.002059712	0.004562838	0.003243754	0.00221444	0.000152526	0.000298268	0.000199788	0.000135	0.000135	7.20E-05	6.28E-05	6.28E-05	6.28E-05	0.000154992
];
y2=[0.000599862	0.001720427	0.007064995	0.008487075	0.012680321	0.014103477	0.020863094	0.022257914	0.009645605	0.000873706	0.001183342	0.005911858	0.000710584	0.00182271	0.00156101	0.001248272	0.003693944	0.005439879	0.000631033	0.002846184	0.018154704	0.012170102	0.006067215	0.011897479	0.000435474	0.005667655	0.001364655	0.004567387	0.000491765	0.003607133	0.007285383	0.001557043	0.006532356	0.001071084	0.001655887	0.008370286	0.001998958	5.82E-05	0.009006095	0.000666576	0.001522353	0.010710208	0.012987285	0.011974931	0.012213647	0.017885573	8.69E-05	0.001011345	0.001903868	0.000247196	0.000847699	0.002165289	0.000368267	0.001567978	0.013317646	0.004666687	0.001132596	0.005516795	0.026991489	0.019450423	0.012515793	0.001552344	0.005395595	0.003898197	0.007613153	0.001567107	0.005694719	0.000335642	0.001170026	0.000356779	0.000883467	0.004952757	0.001276938	0.003935456	0.001275906	0.000634403	0.038544049	0.020471555	0.005867242	0.00319554	0.012102799	0.020988332	0.001435008	0.00750434	0.000290424	0.001887381	0.005992569	0.001471529	0.010196559	0.053196623	0.019007947	0.015216513	0.021820002	0.027960011	0.0165033	0.0160381	0.024541789	0.000540809	0.000435717	0.001821198	0.01631556	0.001799606	0.001878743	0.002215716	0.00016912	0.001276045	0.008470183	0.001235522	0.006269584	0.000243735	0.000762504	0.014005397	0.002088059	0.015333264	0.016276488	0.017965948	0.02319815	0.012032145	0.000111065	0.001273379	0.002915571	0.003182378	0.000718337	0.005719122	0.020050889	0.0001462	0.000571729	0.000721361	0.00058339	0.009726843	0.001546848	0.023580346	0.0013633	0.003023062	0.001807737	0.001341085	0.007149466	0.00042601	0.000507417	0.000624061	0.001984036	0.000416176	0.002104455	0.001955913	0.000429996	0.009210366	0.001889464	0.000137597	0.001999572	0.00246649	0.001979205	0.001387692	0.000933257	4.36E-05	0.000741995	0.000217544	0.00637541	0.013982152	0.016630426	0.028112946	0.005960763	0.004364763	0.011135291	0.01088698	0.000191326	3.90E-05	0.000689557	0.001253492	0.002148236	0.002967311	0.00530066	0.029276465	0.019416008	0.014352725	0.015316401	0.012593314	0.009907102	0.008129129	0.009246365	0.007248505	0.00181219	0.001938655	0.010960857	0.009119884	0.006498197	0.007366971	0.00850411	0.001539156	0.004405803	0.002358453	0.000803482	0.000779383	0.000903553	0.003859579	0.008034477	0.001139138	0.027375188	0.008810236	0.01378431	0.010656597	0.007816703	0.00999862	0.009615761	0.007795102	0.004954002	0.005253977	0.005311287	0.001478401	0.000159597	0.000499004	0.014177818	0.015621557	0.004580594	0.00634145	0.005749285	0.005248556	0.003934512	0.002531143	0.002029346	0.000860016	0.004631901	0.005393544	0.014414758	0.009328175	0.013754462	0.010570907	0.00819249	0.007381023	0.004214509	0.005464728	0.008010607	0.001863465	0.0008855	0.000370281	0.000673672	0.000174729	0.00377788	0.005667437	0.001012825	0.00197064	0.004717114	0.004360224	0.002902657	0.005376637	0.006773233	0.007044624	0.007914337	0.000794645	0.000531435	0.001284548	0.00033274	0.004086494	0.000314515	0.00033997	0.001914979	0.001223246	0.002676574	0.003970435	0.002854771	0.004825582	0.008045022	0.010376873	0.010084935	0.008327825	0.00523585	0.007602224	0.002183276	0.00371048	0.002926687	0.001598282	0.000488888	0.000116178	0.000318057	0.000617007	0.000663391	0.000797977	0.000861658	0.000956832	0.001406306	0.00120216	0.00829582	0.00202042	0.000786883	8.49E-05	0.000364194	8.88E-05	0.005470076	0.003894925	0.003600428	0.003973528	0.002211126	0.00223721	0.001420664	0.001692446	0.00088124	0.000591287	0.013638371	0.000732121	0.001527432	0.006541788	0.00051384	0.000793895	0.012420035	0.000145353	0.000511762	5.28E-05	0.000145323	0.001337309	0.008699485	0.002569803	0.001043962	0.004903843	0.002816669	0.004580297	0.005357399	0.005848341	0.012006062	0.001954696	0.00121149	0.000533694	0.000270589	0.000888309	0.001362318	0.001140376	0.001570454	5.54E-05	0.000145871	0.000892692	2.98E-05	0.00738786	0.001576382	0.004645939	0.002902504	0.001828579	8.32E-05	0.000499356	8.89E-05	0.000141221	0.000141221	9.39E-05	5.28E-05	5.28E-05	5.28E-05	0.000178798
];
y3=[0.000906777	0.00182238	0.008029089	0.007709838	0.011377852	0.01235979	0.017638237	0.023766042	0.008762002	0.000469588	0.000972746	0.004373191	0.000690789	0.001122639	0.000619675	4.85E-06	0.001690169	0.004770558	0.000113559	0.003393869	0.01905819	0.012121955	0.003566568	0.010542312	0.000716812	0.005584532	0.001504054	0.003591236	0.00187147	0.002032867	0.005585123	0.001203569	0.006632504	0.001483023	0.001084365	0.005612693	0.002018292	0.000793499	0.007886019	0.000567043	0.00071274	0.012293455	0.01369183	0.012167054	0.00937566	0.020223009	0.000255303	0.000613548	0.002100102	0.000228677	0.000831891	0.00197095	0.000289387	0.001512901	0.01089645	0.003258243	0.001459328	0.0042135	0.020392948	0.014704829	0.007698323	0.001417491	0.006265156	0.00407162	0.007226349	0.001299502	0.004115445	0.00035219	0.000666993	1.09E-05	0.000732766	0.005408302	0.001337941	0.003500985	0.002048542	0.001092931	0.047296685	0.022959426	0.006785559	0.004629455	0.009736233	0.020009291	0.001895836	0.006362806	0.000237628	0.001327854	0.004652461	0.000962548	0.00812261	0.042833595	0.021646187	0.016201524	0.019379434	0.025337301	0.018559422	0.016861446	0.017240461	3.76E-05	0.001025311	0.003392711	0.022544802	0.00144884	0.001867249	0.003234074	4.47E-05	0.001261086	0.008707072	0.001271893	0.006476525	0.000603255	0.000950388	0.011775868	0.003213194	0.012960086	0.012708623	0.014371555	0.018718232	0.01018507	0.000358838	0.00055371	0.002525862	0.003024572	0.000623799	0.004898684	0.017661796	3.17E-05	0.000196814	0.000669342	0.000198054	0.010090098	0.002338146	0.014204227	0.001406836	0.002504722	0.001041903	0.001002486	0.006688692	0.000820615	0.00012835	0.000333012	0.002361513	0.000131291	0.002301266	0.001787637	0.000418009	0.007274333	0.001654661	0.000196103	0.001664868	0.002251824	0.002034779	0.001422159	0.000816543	6.43E-06	0.000263433	0.000485893	0.004848991	0.013865195	0.016781943	0.02709548	0.011489835	0.001861319	0.013986836	0.007500094	0.000233619	5.44E-05	0.000703262	0.001284915	0.002013808	0.002478904	0.004897698	0.032960322	0.020661074	0.014765113	0.015615708	0.013277769	0.010012502	0.008019909	0.009208172	0.010082459	0.003851791	0.003593507	0.011580044	0.009880596	0.006498819	0.008506356	0.008779552	0.001952391	0.00501853	0.00333446	0.001442836	0.001661754	0.001527423	0.00306631	0.006312237	0.004163801	0.019873702	0.009213688	0.012733309	0.008271916	0.005207523	0.009899392	0.010488763	0.007603601	0.004411831	0.006961478	0.008560128	0.002319318	0.001718948	0.001373518	0.013103979	0.014599903	0.00240642	0.004378615	0.003858281	0.003656432	0.002845031	0.001806933	0.001508855	0.000367218	0.002902918	0.002444987	0.009968975	0.007415003	0.010347801	0.007696935	0.007049648	0.006247994	0.003630499	0.004033976	0.005887477	0.00206934	0.001313234	0.000264693	0.000454912	0.000130771	0.003421919	0.004879025	0.001317682	0.002985172	0.005777739	0.005630224	0.002092982	0.006065055	0.006559928	0.006780573	0.007409543	0.000710043	0.000138452	0.001320606	0.000445817	0.004554487	0.000297444	0.000224218	0.001482866	0.001092229	0.001854722	0.003235712	0.001942768	0.00442999	0.007414462	0.009174434	0.009530686	0.009134634	0.004935771	0.008088431	0.002046512	0.0042839	0.003220426	0.001532506	0.000573509	6.43E-05	0.000102561	0.00031223	0.000469514	0.000523576	0.000531906	0.000696816	0.00101064	0.000814741	0.006013791	0.001484969	0.000408188	9.46E-05	0.000573705	9.61E-05	0.004436586	0.003362406	0.003117131	0.003444448	0.001714355	0.001898657	0.001304269	0.001733327	0.001047231	0.000680059	0.012830587	0.000949599	0.002145583	0.00714002	0.000459782	0.000755356	0.008548259	0.000259174	0.000447943	6.48E-05	0.000175226	0.003453504	0.013973606	0.003607268	0.001226353	0.005221325	0.002841687	0.004694448	0.005812311	0.005865709	0.011931639	0.002880966	0.001697373	0.000340116	5.08E-05	0.000743046	0.000736069	0.00065162	0.002182961	0.000107669	9.19E-05	0.000293617	0.000115607	0.00638022	0.001766432	0.005126229	0.003653041	0.002414683	2.58E-05	0.000266901	0.000267898	0.000142095	0.000142095	6.05E-05	6.48E-05	6.48E-05	6.48E-05	0.000158568
];
y4=[0.000724601	0.002355464	0.007502885	0.008649913	0.013052879	0.012582012	0.021738276	0.028758617	0.010572994	0.000615995	0.001274037	0.00602263	0.000941916	0.001868666	0.000795038	0.000890589	0.004089762	0.007165188	0.001053123	0.003340123	0.017578194	0.01206155	0.006232258	0.011821065	5.6061E-05	0.005793301	0.001510216	0.004551189	9.85634E-05	0.004029192	0.0081164	0.002611987	0.00821819	0.001280161	0.001691298	0.009376551	0.00202775	0.000272733	0.008408747	0.000704408	0.001174945	0.012557795	0.014213907	0.013885009	0.01344639	0.020075388	0.000174542	0.001108382	0.002019363	0.000258025	0.000903392	0.002356594	0.000404535	0.001502283	0.016004351	0.005874959	0.001114703	0.00670056	0.028442983	0.020116857	0.012081892	0.001685883	0.005978546	0.003683332	0.008863315	0.00209699	0.006007338	0.000340213	0.001160751	0.000246977	0.00059827	0.004760545	0.001242137	0.003626884	0.001523367	0.000903391	0.03848651	0.020442669	0.005791161	0.003233526	0.010971407	0.019517224	0.001350009	0.007672038	0.000374637	0.001345046	0.00622246	0.000927229	0.010365092	0.051444514	0.009079543	0.025196291	0.020906513	0.026964422	0.016705984	0.015880023	0.02246547	0.000206988	0.00030561	0.001952529	0.016327046	0.001644381	0.001754582	0.002267839	7.58645E-05	0.001127036	0.008179911	0.001424509	0.006007726	0.000233766	0.000799059	0.012184328	0.003426347	0.014223966	0.014900524	0.016940256	0.022360424	0.011454943	0.00056693	0.00053024	0.002865696	0.003468749	0.000492753	0.005572496	0.019604936	7.82299E-05	0.000441772	0.000746245	0.000244349	0.009414179	0.001666757	0.03329068	0.001033845	0.002504654	0.001852995	0.001132908	0.006800464	0.00055604	0.000376003	0.000245298	0.001935684	0.000137124	0.002211709	0.001765198	0.000594514	0.014259608	0.002086617	0.000190538	0.00212034	0.002323357	0.001889197	0.001330222	0.000496353	0.000215017	0.000516334	0.000379643	0.00631984	0.013898546	0.016608901	0.037513811	0.007619942	0.002904269	0.011309068	0.023050747	1.79562E-05	0.000154283	0.000667067	0.001296526	0.001966764	0.002508078	0.004877406	0.030219116	0.020828353	0.014887851	0.016110098	0.013282282	0.010592684	0.008305391	0.008874056	0.008307531	0.002736239	0.001988476	0.010582385	0.00851707	0.006014713	0.006631752	0.007432933	0.001488977	0.004077021	0.00236508	0.00079396	0.001012369	0.000987838	0.004400727	0.007490442	0.002233896	0.025000801	0.008915415	0.013909236	0.010744687	0.008006424	0.009644032	0.009358699	0.007723454	0.005024805	0.005844537	0.004846566	0.001269027	0.000687522	0.000482121	0.012236152	0.013197813	0.004568408	0.005885494	0.005414563	0.004935814	0.003775137	0.002592569	0.002092572	0.000989916	0.006957774	0.007469419	0.015123457	0.010066241	0.014322752	0.011243398	0.008770129	0.007769583	0.004179337	0.005697899	0.008700061	0.002570584	0.001149659	0.00043164	0.00078837	0.000234351	0.00401698	0.00580117	0.000959384	0.001773172	0.00420684	0.003970104	0.00299986	0.005278209	0.006685471	0.006881646	0.007894908	0.000941496	0.000302576	0.001747805	2.69416E-05	0.005042337	0.000347157	0.000267828	0.001898928	0.00105091	0.002397668	0.003491215	0.002145041	0.00460135	0.007231413	0.009476483	0.009278062	0.007747009	0.004726809	0.007196157	0.00197725	0.00351242	0.002853562	0.00162045	0.00043954	0.000138259	0.000343595	0.000715959	0.000798812	0.000962254	0.0009217	0.001090771	0.001523436	0.001337326	0.013634345	0.003252863	0.000830963	0.000139842	0.000420361	0.000243324	0.006259553	0.003938204	0.003821361	0.004174208	0.002421734	0.002491226	0.001613094	0.001912079	0.001044716	0.000634669	0.01320272	0.000659816	0.001355727	0.006480032	0.000574047	0.000714045	0.012294705	0.000120411	0.000494815	5.60285E-05	9.92901E-05	0.001781453	0.010266633	0.002564945	0.000900954	0.004606384	0.002715497	0.004273106	0.00511304	0.00538141	0.011287171	0.002495555	0.001549289	0.000587282	0.000362706	0.001245543	0.001929534	0.001644045	0.001921372	3.59409E-05	0.000172908	0.000829896	9.67537E-06	0.007251559	0.001951179	0.004413567	0.002692253	0.001897682	0.000188191	0.000341731	0.000130894	0.00014189	0.00014189	7.71085E-05	5.60285E-05	5.60285E-05	5.60285E-05	0.000160588
];
y5=[0.000749434	0.002429929	0.00840825	0.009600847	0.014881191	0.017171341	0.025922207	0.017502874	0.011492104	0.000729756	0.001549052	0.007151289	0.001199222	0.002321047	0.001289969	0.000713235	0.004367027	0.006357037	0.00077214	0.002705237	0.016384537	0.010377766	0.006126205	0.013724811	0.001060779	0.006606415	0.001568983	0.006139517	7.52E-05	0.004168011	0.007684795	0.001587558	0.006622953	0.001194867	0.001902873	0.009866456	0.002498738	0.000168493	0.01082211	0.000717826	0.001842767	0.011100463	0.013361331	0.012812573	0.015541429	0.018203367	0.000409633	0.001044023	0.002291783	0.000260359	0.001178069	0.002929629	0.000357161	0.00186504	0.015709434	0.00514477	0.001402255	0.006265044	0.029144929	0.02080296	0.014039947	0.001662424	0.006153996	0.003952442	0.009455956	0.001600682	0.006905802	0.00048959	0.001457239	0.000840204	0.000694335	0.005243303	0.001360082	0.004380819	0.000774794	0.000240817	0.029302988	0.016474442	0.005287508	0.002542447	0.013862477	0.023543997	0.001709185	0.009208028	0.00017923	0.001792596	0.007052696	0.001782533	0.009732709	0.050553641	0.027738635	0.013574678	0.019290918	0.025460237	0.01484115	0.013458802	0.017390957	0.000750437	0.000477287	0.000902786	0.011668717	0.000968552	0.000712872	0.002099286	0.000106751	0.00123521	0.008514859	0.001555325	0.006706138	6.65E-05	0.000811653	0.012842017	0.004941345	0.01652804	0.017745666	0.020058452	0.026364503	0.014304717	0.000335851	0.001713384	0.003462476	0.002484611	0.000538272	0.005521804	0.019383029	0.000507442	0.001222857	0.000804536	0.000899104	0.008946331	0.001025298	0.024081077	0.001400201	0.002720995	0.00133449	0.001098	0.006229904	0.000416467	0.000390311	0.001055994	0.001874011	0.000238557	0.002241141	0.00225986	0.000361579	0.012124329	0.002186476	0.000266406	0.002381025	0.002467916	0.002331392	0.001621788	0.001043482	0.000485968	0.000796673	9.29E-05	0.006449015	0.012155411	0.014413949	0.035458614	0.002606274	0.002573294	0.008640561	0.00912436	0.000286242	6.73E-05	0.000955354	0.001554547	0.003004683	0.003548806	0.006634521	0.023346514	0.01695945	0.012957536	0.014025135	0.011043781	0.008795895	0.007613474	0.011182623	0.008864266	0.001883308	0.00246787	0.008587873	0.006870494	0.004768454	0.005240943	0.006125394	0.001319905	0.003403323	0.001761802	0.000779803	0.000543353	0.000754355	0.00335951	0.007877155	0.003755202	0.019853615	0.005154894	0.014396164	0.011896394	0.008550073	0.0107078	0.009886846	0.007054254	0.006552112	0.005055182	0.004227433	0.001419007	0.000538466	0.000574692	0.012737349	0.013993156	0.005020593	0.006282807	0.006000683	0.00530381	0.004487382	0.002985229	0.002480247	0.001230786	0.004844752	0.005177059	0.016219846	0.010165531	0.015001819	0.011278732	0.009128269	0.008786762	0.003920653	0.00614525	0.009161435	0.002034584	0.001114598	0.00047594	0.00079664	3.89E-06	0.003765184	0.005802548	0.000601932	0.001177369	0.004055598	0.004156834	0.002414579	0.004640732	0.00654583	0.006473254	0.007646049	0.000514991	0.00013859	0.000908943	0.000211163	0.003712747	0.000280496	0.000417462	0.001687676	0.000952567	0.002577636	0.003675056	0.002693246	0.004975961	0.008684571	0.011230837	0.010532754	0.008591374	0.005393433	0.007228827	0.002453823	0.003788545	0.002855121	0.001518809	0.000485971	0.000218607	0.00048454	0.001053289	0.001157057	0.001368143	0.001235065	0.001577991	0.002084127	0.001821228	0.010988927	0.003014885	0.000963711	8.55E-05	0.000555715	0.000171576	0.006487819	0.004580911	0.003956139	0.004522375	0.00276924	0.002465763	0.001713652	0.001915133	0.001016056	0.000783631	0.011468516	0.000809052	0.001578115	0.006259866	0.000178532	0.000616316	0.013389091	0.000157392	0.00042449	5.66E-05	0.000311314	0.000601811	0.004696743	0.002042452	0.000971639	0.003815318	0.002579031	0.003760589	0.004246881	0.004661561	0.010989935	0.001801893	0.001004546	0.000502463	0.000257203	0.001061162	0.001774191	0.001221721	0.001210104	0.000229741	0.000215716	0.001429992	0.000239291	0.007360174	0.002488347	0.004392068	0.002482873	0.001325937	0.000284931	0.00041108	7.14E-05	0.000187264	0.000187264	0.000186118	5.66E-05	5.66E-05	5.66E-05	0.000143163
];
y6=[0.000442292	0.001459174	0.005006401	0.006619002	0.0095257	0.009746759	0.013091268	0.0274398	0.005739776	5.39E-05	0.001246601	0.004710001	0.000148696	0.001016444	0.000999864	0.001886616	0.004243355	0.005315403	5.88E-05	0.003467415	0.013543054	0.011245734	0.005293715	0.008454979	0.00047512	0.003663253	0.001076175	0.003113086	0.001527755	0.003134961	0.006003731	0.001928789	0.005589532	0.000491276	0.00138168	0.007733477	0.000971356	0.000276724	0.004875298	0.000431693	0.000890286	0.00917651	0.011771853	0.010222666	0.008764802	0.013040341	0.000235183	0.00166673	0.001638411	0.000354884	0.000396383	0.001024707	0.00010392	0.001409278	0.011838858	0.004751017	0.000654808	0.005052265	0.022846836	0.015111117	0.009072821	0.001358221	0.004503281	0.003640432	0.005856857	0.000992072	0.004072146	7.11E-05	0.001136978	4.31E-05	0.000841001	0.003523507	0.000986609	0.00358542	0.001885997	0.000973708	0.044416763	0.021940762	0.003720554	0.003312328	0.008778079	0.014575062	0.000434189	0.005354374	0.000386575	0.001309616	0.004312438	0.000146624	0.011197655	0.048916964	0.024486525	0.010795909	0.020509921	0.026218649	0.012974965	0.01912828	0.02610929	0.000244106	0.000744026	0.001972085	0.019413828	0.002278104	0.002764336	0.00205073	0.000448186	0.001505522	0.006243006	0.001033516	0.005620628	0.000943531	0.000463266	0.010529567	0.000603971	0.010036451	0.00909318	0.010303866	0.014195521	0.007691026	0.000116619	0.000705387	0.001401976	0.003647854	0.000201364	0.00700595	0.017899121	0.000710701	0.000864275	0.000838099	0.000345891	0.008538412	0.001011416	0.041932386	0.000723784	0.002459246	0.002617921	0.001134863	0.005895068	0.000778266	0.00063521	0.000719221	0.001858171	0.000203498	0.002335572	0.001635822	0.000268519	0.015511643	0.002003811	1.24E-05	0.001664662	0.002278682	0.001284323	0.000977271	0.000829117	0.001095345	0.000855403	0.000821647	0.005492917	0.015872017	0.020641254	0.019083409	0.011357732	0.005981204	0.014021285	0.008633515	2.23E-05	0.000296757	0.000376224	0.000714762	0.000795723	0.001214123	0.002680885	0.029965812	0.02348019	0.015933981	0.01716808	0.013828408	0.010830258	0.008612149	0.008016435	0.004825425	0.000533481	0.000733286	0.010677717	0.007762487	0.005075304	0.006360319	0.006647796	0.000239654	0.004206157	0.002416682	0.000133462	0.000624404	0.000887711	0.003947834	0.005692311	0.003181786	0.029996207	0.011629742	0.009923202	0.006692609	0.005032867	0.00620531	0.006112237	0.005297627	0.002523414	0.005823996	0.004052935	0.001409276	0.000739267	0.000326993	0.010239148	0.009799868	0.002397753	0.003578418	0.004605742	0.003917712	0.002388091	0.00154177	0.001353011	0.000576659	0.010496786	0.008184513	0.0110137	0.005722993	0.01168201	0.008465344	0.005920912	0.004981438	0.003480172	0.003825522	0.008832516	0.002489333	0.000368367	0.000595345	0.000778541	0.00010255	0.00358445	0.00495248	0.001233593	0.002251289	0.004449336	0.002743734	0.002183327	0.004463128	0.005154789	0.005715359	0.006376943	0.000653597	0.000413268	0.001001272	0.001064989	0.004047364	0.000375633	0.000422604	0.002385178	0.000418766	0.002184874	0.003175258	0.001755304	0.003434601	0.005353253	0.007398601	0.006853237	0.00464096	0.002919082	0.00616564	0.000574759	0.002306969	0.001876017	0.001347126	0.000263417	9.55E-05	0.000149006	0.000434531	0.000349382	0.000503683	0.000214638	0.000597265	0.000952142	0.000917249	0.015557965	0.003639409	0.000424193	8.35E-05	1.12E-05	7.41E-05	0.003909698	0.003017188	0.002394872	0.002438233	0.001248744	0.001585053	0.000969459	0.001306826	0.000456121	0.00032744	0.016029977	0.000592039	0.001294519	0.007158043	0.000748629	0.000645368	0.009116267	8.44E-05	0.000467183	3.59E-05	0.000141978	0.003396981	0.015522901	0.00265134	0.000775525	0.004924738	0.002384341	0.003716682	0.004531857	0.005152475	0.007356797	0.002855886	0.000938579	0.000545943	8.99E-05	0.000640447	0.001273859	0.000488435	0.001490797	9.81E-05	6.62E-05	0.000488127	0.00016192	0.007129282	0.0015458	0.003747512	0.002445618	0.001071094	0.000515588	0.000371029	0.000147042	9.45E-05	9.45E-05	6.51E-05	3.59E-05	3.59E-05	3.59E-05	0.000206733
];

subplot(2,1,1);
plot(x,y1)
subplot(2,1,2); 
plot(x,y2)

figure(1);
createfigure1(x, y3)
figure;
createfigure1(x, y4)
figure;
createfigure1(x, y5)
figure;
createfigure1(x, y6)

ax = gca;
ax.YAxis.Exponent = -2;%常数2为指数值，改为0即不使用科学计数法







